@Author: <u>chinyan</u>

# 学分管理系统后端搭建

## 一、后台开发环境

### 1、使用技术

* Express+ES6+MySQL 

* 服务器环境Node

  > 1.创建package.json
  >
  > ```
  > npm init -y
  > ```
  >
  > 2.使用npm下载插件
  >
  > ```
  > npm i express mysql express-session await-to-js svg-captcha 
  > ```
  
* 版本控制 Git

### 2、搭建项目文件夹并确定功能

#### 2.1 入口文件 app.js

#### 2.2 公共业务文件夹until

* 公共业务文件夹 until.js

#### 2.3 数据库层文件夹 db

* 数据连接文件 DBConnect.js
* 数据库配置文件 DBConfig.js

#### 2.4 业务层文件夹 model

* 学生业务文件userModel.js
* 组织业务文件teamModel.js
* 管理员业务文件adminModel.js

#### 2.5 创建路由层文件夹router

* 学生接口路由文件studentRouter.js
* 组织接口路由文件teamRouter.js
* 管理员接口路由文件adminRouter.js
* 首页(活动展示界面)路由文件mainRouter.js

## 二、模块分层搭建

### 1、首页模块

#### 1.1 活动搜索

##### 1.1.1 活动搜索

> 接口层

* 接口名： /getActiveSearch
* 请求方式： get
* 参数：无
* 返回值： {code:"消息码",activeList}
* 功能：根据搜索内容查找活动

> 业务层

* 方法名：getActiveSearch

* 数据库语句：（未测试）

  ` select active_name from activity order by issue_time DESC`

#### 1.2 活动展示

##### 1.2.1 活动展示

> 接口层

* 接口名：/getActiveShow
* 请求方式：get
* 参数：无
* 返回值：{code:"消息码",activeList}
* 功能：展示所有已发布活动

> 业务层

* 方法名：getActiveShow

* 数据库语句：（未测试）

  ` select * from activity`

##### 1.2.2 加入活动

> 接口层

* 接口名：/joinActive
* 请求方式：post
* 参数：join {user_id,active_id,active_class,join_msg}
* 返回值：{code:"消息码",msg:"消息"}
* 功能：加入该活动

> 业务层

* 方法名：

* 数据库语句：（未测试）

```
insert join(user_id,active_id,active_class,join_msg) value(${user_id},${active_id},${active_class},"N");  
```

### 2、用户模块

#### 2.1 登录

##### 2.1.1 用户登录

> 接口层

* 接口名：/userLogin
* 请求方式：post
* 参数：user {user_id,user_pwd}
* 返回值：{code:"消息码",msg:"消息"}
* 功能：登录用户接口，密码需要使用MD5加密

> 业务层

* 方法名：userLogin

* 数据库语句：（未测试）

  ` select * from user where user_id=? and uesr_pwd=?`

##### 2.1.2 组织登录

> 接口层

* 接口名：/teamLogin
* 请求方式：post
* 参数：team {team_id,team_pwd}
* 返回值：{code:"消息码",msg:"消息"}
* 功能：登录用户接口，密码需要使用MD5加密

> 业务层

* 方法名：teamLogin

* 数据库语句：（未测试）

  ` select * from team where team_id=? and team_pwd=?`

##### 2.1.3 组织注册

> 接口层

* 接口名：/teamReguest
* 请求方式：post
* 参数：team {team_id,team_pwd,team_name,team_msg}
* 返回值：{code:"消息码",msg:"消息"}
* 功能：组织注册，密码需要使用MD5加密

> 业务层

* 方法名：teamReguest

* 数据库语句：（未测试）

  ` insert team(team_id,team_pwd,team_name,team_msg) value(?,?,?,?)`

#### 2.2 用户管理

##### 2.2.1 学生个人中心

> **个人信息展示**
>
> > 接口层

* 接口名：/studentShow
* 请求方式：post
* 参数：user {user_id,user_name,user_pwd,society,science,user_msg}
* 返回值：{code:"消息码",msg:"消息"}
* 功能：展示个人信息

> > 业务层

* 方法名：studentShow

* 数据库语句：（未测试）

  ` select * from user where user_id = ?     ` 

> **个人信息修改**
>
> > 接口层

* 接口名：/studentUpdate
* 请求方式：post
* 参数：user {user_pwd,user_msg}
* 返回值：{code:"消息码",msg:"消息"}
* 功能：展示个人信息

> > 业务层

* 方法名：studentShow

* 数据库语句：（未测试）

  ` update user set user_pwd,user_msg where user_id=?`

> **参加活动查询**
>
> > 接口层

* 接口名：/joinActive
* 请求方式：post
* 参数：join {active_id,active_class,join_msg}
* 返回值：{code:"消息码",msg:"消息"}
* 功能：展示已报名活动

> > 业务层

* 方法名：joinActive

* 数据库语句：（未测试）

  ` select * from join where user_id = ? `

> **退出活动**
>
> > 接口层

* 接口名：/outActive
* 请求方式：post
* 参数：user_id
* 返回值：{code:"消息码",msg:"消息"}
* 功能：退出活动

> > 业务层

* 方法名：outActive

* 数据库语句：（未测试）

  ` delete from join where user_id=?`

##### 2.2.2 组织管理

##### 2.2.3 管理员管理

